{
    "name": "Find shortest Paths from Azure Users to subscription",
    "category": "Azure - Paths",
    "queryList": [
        {
            "final": true,
            "query": "MATCH (n:AZUser) WITH n MATCH p = shortestPath((n)-[r*1..]->(g:AZSubscription)) RETURN p"
        }
    ]
}
{
    "name": "Find all Paths to Azure VMs",
    "category": "Azure - Paths",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p = (n)-[r]->(g:AZVM) RETURN p"
        }
    ]
}
{
    "name": "Find shortest Path from Owned Azure Users to VMs",
    "category": "Azure - Paths",
    "queryList": [
        {
            "final": true,
            "query": "MATCH (n:AZVM) MATCH p = shortestPath((m:AZUser{owned: true})-[*..]->(n)) RETURN p",
            "allowCollapse": true
        }
    ]
}
{
    "name": "Find all Paths to Azure KeyVaults",
    "category": "Azure - Paths",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p = (n)-[r]->(g:AZKeyVault) RETURN p"
        }
    ]
}
{
    "name": "Find all Paths to Azure KeyVaults from Owned Principals",
    "category": "Azure - Paths",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p = ({owned: true})-[r]->(g:AZKeyVault) RETURN p",
            "allowCollapse": true
        }
    ]
}
{
    "name": "Find shortest Paths to Azure subscription",
    "category": "Azure - Paths",
    "queryList": [
        {
            "final": true,
            "query": "MATCH (n:AZSubscription), (m), p=shortestPath((m)-[r*1..]->(n)) WHERE NOT m=n RETURN p",
            "allowCollapse": true
        }
    ]
}