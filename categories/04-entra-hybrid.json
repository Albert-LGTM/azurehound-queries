{
    "name": "Find all users originating from on-premises with an active Entra ID role",
    "category": "Hybrid - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH (node) WHERE (node.onpremisesyncenabled = true) MATCH p = (node)-[:AZHasRole|AZMemberOf*1..2]->(r:AZRole WHERE r.displayname CONTAINS('Administrator')) RETURN p"
        }
    ]
}
{
    "name": "Find all Synchronization accounts possibly used for Entra ID Connect",
    "category": "Hybrid - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH (u) WHERE (u:User OR u:AZUser) AND (u.name =~ '(?i)^MSOL_|.*AADConnect.*' OR u.userprincipalname =~ '(?i)^sync_.*') OPTIONAL MATCH (u)-[:HasSession]->(s:Session) RETURN u, s",
            "allowCollapse": true
        }
    ]
}