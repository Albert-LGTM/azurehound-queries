{
    "name": "Find all active Global Administratorssps",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p =(n)-[r:AZGlobalAdmin*1..]->(m) RETURN p"
        }
    ]
}
{
    "name": "Find all active sensitive non-M365 Entra ID Administrators (last updated: 2024-01-24)",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p=(n)-[:AZHasRole|AZMemberOf*1..2]->(r:AZRole WHERE r.displayname =~ '(?i)Application Administrator|Authentication Administrator|Authentication Policy Administrator|Azure DevOps Administrator|Azure Information Protection Administrator|B2C IEF Keyset Administrator|Cloud Application Administrator|Cloud Device Administrator|Conditional Access Administrator|Directory Writers|External Identity Provider Administrator|Global Administrator|Groups Administrator|Helpdesk Administrator|Hybrid Identity Administrator|Intune Administrator|Microsoft Entra Joined Device Local Administrator|Partner Tier1 Support|Partner Tier2 Support|Password Administrator|Privileged Authentication Administrator|Privileged Role Administrator|User Administrator|Windows 365 Administrator') RETURN p"
        }
    ]
}
{
    "name": "Find all active M365 Administrators (last updated: 2024-01-24)",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p=(n)-[:AZHasRole|AZMemberOf*1..2]->(r:AZRole WHERE r.displayname =~ '(?i)Dynamics 365 Administrator|Exchange Administrator|Fabric Administrator|Kaizala Administrator|Power Platform Administrator|SharePoint Administrator|Skype for Business Administrator|Teams Administrator|Viva Goals Administrator|Viva Pulse Administrator|Yammer Administrator') RETURN p"
        }
    ]
}
{
    "name": "Find all groups with an active Entra ID role",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p = (m:AZGroup)-[r:AZHasRole]->(n:AZRole) RETURN p"
        }
    ]
}
{
    "name": "Find all groups with a potentially eligible Entra ID role",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true, 
            "query": "MATCH (g:AZGroup {isassignabletorole: True}) RETURN g"
        }
    ]
}
{
    "name": "Find all dynamic groups with an active Entra ID role",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH (g) WHERE EXISTS(g.membershipRule) MATCH p = (g)-[r:AZHasRole]->(n:AZRole) RETURN p"
        }
    ]
}
{
    "name": "Find all dynamic groups",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH (g) WHERE EXISTS(g.membershipRule) RETURN g"
        }
    ]
}
{
    "name": "Find all identities with an active Entra ID Role",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p = (n)-[:AZHasRole|AZMemberOf*1..2]->(r:AZRole WHERE r.displayname CONTAINS('Administrator')) RETURN p"
        }
    ]
}
{
    "name": "Find all owners of Entra ID Applications",
    "category": "Entra ID - General",
    "queryList": [
        {
            "final": true,
            "query": "MATCH p = (n)-[r:AZOwns]->(g:AZApp) RETURN p"
        }
    ]
}